mixed-port: 1080
tproxy-port: 1536
log-level: error
mode: rule
udp: true
find-process-mode: strict
ipv6: true
tcp-concurrent: true
unified-delay: true

global-client-fingerprint: chrome
global-ua: clash.meta
etag-support: true

allow-lan: true
bind-address: "*"

disable-keep-alive: true
keep-alive-interval: 15
keep-alive-idle: 15

geodata-loader: memconservative
geosite-matcher: succinct

external-controller: 127.0.0.1:9090
secret: "ksc666"
external-ui: "./zashboard"
external-ui-url: "https://github.com/Zephyruso/zashboard/archive/refs/heads/gh-pages.zip" # è‡ªå®šä¹‰å¤–éƒ¨ç”¨æˆ·ç•Œé¢ä¸‹è½½åœ°å€

profile:
  store-selected: true # å‚¨å­˜ API å¯¹ç­–ç•¥ç»„çš„é€‰æ‹©ï¼Œä»¥ä¾›ä¸‹æ¬¡å¯åŠ¨æ—¶ä½¿ç”¨
  store-fake-ip: true # å‚¨å­˜ fakeip æ˜ å°„è¡¨ï¼ŒåŸŸåå†æ¬¡å‘ç”Ÿè¿æ¥æ—¶ï¼Œä½¿ç”¨åŸæœ‰æ˜ å°„åœ°å€

tun:
  enable: false
  device: utun0
  stack: mixed
  auto-route: true
  auto-redirect: false
  auto-detect-interface: true
  dns-hijack:
    - "any:53"
    - "tcp://any:53"
  strict-route: true
  route-exclude-address:
    - "192.168.0.0/16"
    - "fc00::/7"

sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  override-destination: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-src-address:
    - 192.168.0.3/32
  skip-dst-address:
    - 192.168.0.3/32
  skip-domain:
    - "RULE-SET:private"
    - "Mijia Cloud"
    - "+.push.apple.com"

dns:
  enable: true
  cache-algorithm: arc
  prefer-h3: false
  use-hosts: true
  use-system-hosts: true
  respect-rules: true
  listen: 0.0.0.0:1053
  ipv6: true
  ipv6-timeout: 600
  default-nameserver:
    - https://223.5.5.5/dns-query
    - https://120.53.53.53/dns-query
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.0/15
  fake-ip-filter-mode: blacklist
  fake-ip-filter:
    - "RULE-SET:private"
  nameserver-policy:
    "+.arpa": "10.0.0.1"
    "RULE-SET:cn,private":
      - https://223.5.5.5/dns-query
      - https://120.53.53.53/dns-query
  nameserver:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
  direct-nameserver:
    - https://223.5.5.5/dns-query
    - https://120.53.53.53/dns-query
  proxy-server-nameserver:
    - https://223.5.5.5/dns-query
    - https://120.53.53.53/dns-query

proxies:
  - {name: ğŸŒ DNSåŠ«æŒ, type: dns}
  - {name: ğŸ‡¨ğŸ‡³ å›½å†…ç›´è¿, type: direct, udp: true}

p: &p {type: http, interval: 86400, proxy: "èŠ‚ç‚¹ä¸‹è½½", exclude-filter: "å¥—é¤|æµé‡|ç¾¤ç»„|é¢‘é“|å®˜ç½‘|æ¨èä½¿ç”¨|æµ‹è¯•|ç”µæŠ¥|æé€Ÿ666|é˜²å¤±è”|èŠ‚ç‚¹è¶…æ—¶", exclude-type: "http", health-check: {enable: true, url: "https://www.gstatic.com/generate_204", interval: 3600, timeout: 3000, max-failed-times: 5, lazy: true}}
pr: &pr {type: select, proxies: [æ‰‹åŠ¨é€‰æ‹©, è‡ªåŠ¨é€‰æ‹©, æ•…éšœè½¬ç§», è´Ÿè½½å‡è¡¡, ğŸ‡¨ğŸ‡³ å›½å†…ç›´è¿, æµé‡æ‹¦æˆª, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, éŸ©å›½, æ–°åŠ å¡, ç¾å›½, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹]}

proxy-providers:
  mojie: {<<: *p, url: "https://www.mojie.cyou/#/register?code=a0sBIylV", override: {additional-prefix: "é­”æˆ’ï½œ"}}
  dingjijichang: {<<: *p, url: "https://xn--mes358a9urctx.com/#/register?code=wiPXjyYq", override: {additional-prefix: "é¡¶çº§æœºåœºï½œ"}}
  feiniaoyun: {<<: *p, url: "https://www.feiniaoyun.xyz/#/register?code=1gZX21aI", override: {additional-prefix: "é£é¸Ÿäº‘ï½œ"}}
  Miaona: {<<: *p, url: "https://miaona.org/#/register?code=C3J67GSL", override: {additional-prefix: "Miaonaï½œ"}}
  jisuyun: {<<: *p, url: "https://w2.rouhe88.com/#/register?code=Zl5IqVKd", override: {additional-prefix: "æé€Ÿäº‘ï½œ"}}

proxy-groups:
  - {name: æ‰‹åŠ¨é€‰æ‹©, type: select, proxies: [è‡ªåŠ¨é€‰æ‹©, æ•…éšœè½¬ç§», è´Ÿè½½å‡è¡¡, ğŸ‡¨ğŸ‡³ å›½å†…ç›´è¿, æµé‡æ‹¦æˆª, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, éŸ©å›½, æ–°åŠ å¡, ç¾å›½, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹], icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/Clubhouse.png}
  - {name: è‡ªåŠ¨é€‰æ‹©, type: url-test, include-all-providers: true, tolerance: 10, icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/Auto.png}
  - {name: æ•…éšœè½¬ç§», type: fallback, include-all-providers: true, icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/ULB.png}
  - {name: è´Ÿè½½å‡è¡¡, type: load-balance, strategy: sticky-sessions, include-all-providers: true, icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/load-balance.png}

  - {name: è‡ªå®šä¹‰æµé‡, <<: *pr, icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/zdy.png}
  - {name: èŠ‚ç‚¹ä¸‹è½½, <<: *pr, icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/Download.png}
  - {name: æ¼ç½‘ä¹‹é±¼, <<: *pr, icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/Final.png}
  - {name: æµé‡æ‹¦æˆª, type: select, proxies: [REJECT-DROP, REJECT, PASS], icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/Reject.png}
  
  - {name: é¦™æ¸¯, type: url-test, include-all-providers: true, filter: "(?i)ğŸ‡­ğŸ‡°|æ¸¯|hk|hongkong|hong kong", icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/HongKong.png}
  - {name: å°æ¹¾, type: url-test, include-all-providers: true, filter: "(?i)ğŸ‡¹ğŸ‡¼|å°|tw|taiwan|tai", icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/Taiwan.png}
  - {name: æ—¥æœ¬, type: url-test, include-all-providers: true, filter: "(?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|jp|japan", icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/Japan.png}
  - {name: éŸ©å›½, type: url-test, include-all-providers: true, filter: "(?i)ğŸ‡°ğŸ‡·|éŸ©|kr|korea", icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/Korea.png}
  - {name: æ–°åŠ å¡, type: url-test, include-all-providers: true, filter: "(?i)ğŸ‡¸ğŸ‡¬|æ–°|sg|singapore", icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/Singapore.png}
  - {name: ç¾å›½, type: url-test, include-all-providers: true, exclude-filter: "(?i)RU", filter: "(?i)ğŸ‡ºğŸ‡¸|ç¾|us|unitedstates|united states", icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/United_States.png}
  - {name: å…¶å®ƒåœ°åŒº, type: url-test, include-all-providers: true, exclude-filter: "(?i)ğŸ‡­ğŸ‡°|æ¸¯|hk|hongkong|hong kong|ğŸ‡¹ğŸ‡¼|å°|tw|taiwan|tai|ğŸ‡°ğŸ‡·|éŸ©|kr|korea|ğŸ‡¯ğŸ‡µ|æ—¥|jp|japan|ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|sg|singapore|ğŸ‡ºğŸ‡¸|ç¾|us|unitedstates|united states", icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/qitadiqu.png}
  - {name: å…¨éƒ¨èŠ‚ç‚¹, type: url-test, include-all-providers: true, icon: https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/icon/quanbujiedian.png}

rule-anchor:
  ip: &ip {type: http, interval: 86400, behavior: ipcidr, format: mrs}
  domain: &domain {type: http, interval: 86400, behavior: domain, format: mrs}

rule-providers:
  private: {<<: *domain, path: ./rule_set/private.mrs, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/private.mrs"}
  cn: {<<: *domain, path: ./rule_set/cn.mrs, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.mrs"}
  direct_domain: {<<: *domain, path: ./rule_set/direct.yaml, format: yaml, url: "https://raw.githubusercontent.com/Sfssup/mihomo-set/refs/heads/main/rule_set/direct.yaml"}
  category-ads-all: {<<: *domain, path: ./rule_set/category-ads-all.mrs, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/category-ads-all.mrs"}
  private_ip: {<<: *ip, path: ./rule_set/private_ip.mrs, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/private.mrs"}
  
rules:

  - DST-PORT,53,ğŸŒ DNSåŠ«æŒ
  - RULE-SET,private,ğŸ‡¨ğŸ‡³ å›½å†…ç›´è¿
  - RULE-SET,category-ads-all,æµé‡æ‹¦æˆª
  - RULE-SET,direct_domain,è‡ªå®šä¹‰æµé‡
  - RULE-SET,cn,ğŸ‡¨ğŸ‡³ å›½å†…ç›´è¿
  - RULE-SET,private_ip,ğŸ‡¨ğŸ‡³ å›½å†…ç›´è¿,no-resolve
  - RULE-SET,cn_ip,ğŸ‡¨ğŸ‡³ å›½å†…ç›´è¿

  - MATCH,æ¼ç½‘ä¹‹é±¼

